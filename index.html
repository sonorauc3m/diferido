<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Diferido Â· Sonora UC3M</title>

<style>
:root{
  --sonora:#be1622;
  --sonora-dark:#46070B;
  --black:#000000;
  --white:#ffffff;
  --soft:#bbbbbb;
}

/* RESET */
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;}

/* ðŸ”¥ FONDO NUEVO SIN BUGS */
body{
  font-family:"Helvetica Now Display","Helvetica Neue",system-ui,sans-serif;
  background:
    radial-gradient(circle at 50% -20%, rgba(190,22,34,1) 0%,
    rgba(120,10,18,0.7) 40%, rgba(50,0,6,0.85) 70%, #000 100%);
  background-attachment:fixed;
  color:#fff;
  display:flex;
  justify-content:center;
}

/* CONTENEDOR PRINCIPAL */
.page{
  width:100%;
  max-width:900px;
  padding:22px 18px 120px;
  text-align:center;
}

/* LOGO */
.logo{
  width:58%;
  max-width:320px;
  margin:0 auto 28px;
  display:block;
}

/* TITULO */
h1{
  font-size:1.8rem;
  margin-bottom:6px;
  font-weight:800;
}
.sub{
  font-size:0.9rem;
  opacity:0.85;
  margin-bottom:26px;
}

/* GRID PROGRAMAS */
.grid{
  display:grid;
  grid-template-columns:1fr;
  gap:18px;
}
@media(min-width:600px){
  .grid{
    grid-template-columns:repeat(2,1fr);
  }
}
@media(min-width:960px){
  .grid{
    grid-template-columns:repeat(3,1fr);
  }
}

/* TARJETA */
.card{
  background:rgba(0,0,0,0.55);
  border-radius:16px;
  padding:16px 18px;
  border:1px solid rgba(255,255,255,0.12);
  backdrop-filter:blur(20px);
  box-shadow:0 12px 28px rgba(0,0,0,0.7);
  display:flex;
  flex-direction:column;
  text-align:left;
  gap:8px;
}
/* NOMBRE */
.card-title{
  font-size:1.03rem;
  font-weight:700;
  letter-spacing:0.6px;
}
/* DESCRIPCIÃ“N */
.card-desc{
  font-size:0.82rem;
  color:var(--soft);
  line-height:1.36;
}

/* BOTONES */
.btns{
  margin-top:6px;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.play{
  background:#fff;
  color:var(--sonora-dark);
  padding:6px 14px;
  font-size:0.78rem;
  border-radius:999px;
  font-weight:700;
  text-decoration:none;
}
.play:hover{
  filter:brightness(1.06);
}
</style>
</head>
<body>

<div class="page">

  <!-- LOGO SONORA -->
  <img src="sonora_2.1_blanco.png" class="logo">

  <h1>Programas en diferido</h1>
  <div class="sub">Disfruta cuando quieras â€” Spotify Â· iVoox Â· YouTube</div>

  <div id="programas" class="grid">Cargandoâ€¦</div>

</div>

<script>
/* Google Sheets config */
const SHEET_ID="1g9f3Ue9GtdaTbpxp3DCXncrNPhjnHPk0m9QTXdfSAxM";
const SHEET="OnDemand";

function gviz(sheet){
  return `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${sheet}`;
}

async function load(){
  const box=document.getElementById("programas");
  box.innerHTML="Cargandoâ€¦";

  try{
    const r=await fetch(gviz(SHEET));
    const raw=await r.text();
    const data=JSON.parse(raw.substr(47).slice(0,-2));
    const rows=data.table.rows.slice(1);

    box.innerHTML="";

    rows.forEach(row=>{
      const c=row.c.map(e=>e?e.v:"");
      const [name,desc,spot,ivoox,yt]=c;
      if(!name)return;

      const card=document.createElement("div");
      card.className="card";

      card.innerHTML=`
        <div class="card-title">${name}</div>
        <div class="card-desc">${desc||""}</div>
      `;

      const btns=document.createElement("div");
      btns.className="btns";

      if(spot) btns.innerHTML+=`<a class="play" target="_blank" href="${spot}">Spotify</a>`;
      if(ivoox)btns.innerHTML+=`<a class="play" target="_blank" href="${ivoox}">iVoox</a>`;
      if(yt)   btns.innerHTML+=`<a class="play" target="_blank" href="${yt}">YouTube</a>`;

      card.appendChild(btns);
      box.appendChild(card);
    });

    if(!box.innerHTML.trim())
      box.innerHTML="No hay programas todavÃ­a.";

  }catch(e){
    box.innerHTML="Error cargando contenido.";
  }
}

load();
setInterval(load,20000); // refresco cada 20s
</script>

</body>
</html>
